<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Login Google Firebase</title>
<script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.2.0/firebase-auth-compat.js"></script>
</head>
<body>
<h2>Login con Google</h2>
<button id="loginGoogle">Iniciar sesi√≥n con Google</button>
<div id="userInfo" style="margin-top:20px;"></div>

<script>
    const firebaseConfig = {
      apiKey: "AIzaSyBCTDohD_NTVvK394Eo07v9x6IdIYbW8eo",
      authDomain: "blog2025-9cdf7.firebaseapp.com",
      projectId: "blog2025-9cdf7",
      storageBucket: "blog2025-9cdf7.firebasestorage.app",
      messagingSenderId: "772020230767",
      appId: "1:772020230767:web:5a852fd674ed5ec24bcb9a"
    };



firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();

document.getElementById('loginGoogle').addEventListener('click', async () => {
    const provider = new firebase.auth.GoogleAuthProvider();
    try {
        const result = await auth.signInWithPopup(provider);
        const token = await result.user.getIdToken();

        // Enviar token a Django
        const res = await fetch('http://127.0.0.1:8000/users/login/firebase/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer ' + token
            }
        });
        const data = await res.json();
        document.getElementById('userInfo').innerText = JSON.stringify(data.user, null, 2);
    } catch (err) {
        console.error(err);
    }
});
</script>
</body>
</html>
